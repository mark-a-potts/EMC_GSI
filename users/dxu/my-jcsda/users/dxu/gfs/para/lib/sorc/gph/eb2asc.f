       SUBROUTINE EB2ASC(NCHAR,LEXBCD,LASCII)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    EB2ASC      TO TRANSLATE A CHARACTER STRING FROM EBCD
C   PRGMMR: KRISHNA KUMAR     ORG: W/NP12  DATE: 1999-08-20
C
C ABSTRACT: TO TRANSLATE A CHARACTER STRING FROM EBCIC TO ASCII TO
C   REPLACE SUBR W3AI38.
C
C PROGRAM HISTORY LOG:
C   88-07-06  ORIGINAL AUTHOR  DAVE S.
C   89-12-12  LUKE LIN  MODIFY AND ADD DOCBLOCK.
C   94-11-09  LUKE LIN  CONVERT IT TO CFT-77.
C 1999-08-20  KRISHNA KUMAR CONVERTED THIS CODE FROM CRAY 
C             TO IBM RS/6000. 
C
C USAGE:    CALL EB2ASC(NCHAR, LEXBCD, LASCII, IERR)
C   INPUT ARGUMENT LIST:
C     NCHAR    - = NO. OF CHAR TO BE TRANSLATED
C     LEXBCD   - = THE GIVEN CHARACTER STRING (IN EBCDIC)
C     LASCII   - = THE RESULTING TRANSLATED STRING (IN ASCII)
C
C REMARKS:
C   SOME SPECIAL CHARACTERS FOR AFOS TRANSLATION SUCH AS "PUNCH" SIGN.
C
C ATTRIBUTES:
C   LANGUAGE: F90
C   MACHINE:  IBM
C
C$$$
C
       INTEGER  NCHAR
       CHARACTER*1  LASCII(NCHAR)
       CHARACTER*1  LEXBCD(NCHAR)
       CHARACTER*1 LTABLE(256)
       INTEGER   GTABLE(32)
       EQUIVALENCE (LTABLE(1), GTABLE(1))
C
       DATA        GTABLE                /
     A Z'000102035C095C7F',
     & Z'5C5C5C0B0C0D0E0F',
     1 Z'101112135C5C085C',
     & Z'18195C5C1C1D1E1F',
     2 Z'5C5C5C5C5C0A171B',
     & Z'5C5C5C5C5C050607',
     3 Z'5C5C165C5C5C5C04',
     & Z'5C5C5C5C14155C1A',
     4 Z'205C5C5C5C5C5C5C',
     & Z'5C5C5B2E3C282B21',
     5 Z'265C5C5C5C5C5C5C',
     & Z'5C5C5D242A293B5E',
     6 Z'2D2F5C5C5C5C5C5C',
     & Z'5C5C7C2C255F3E3F',
     7 Z'5C5C5C5C5C5C5C5C',
     & Z'5C603A2040273D22',
     8 Z'5C61626364656667',
     & Z'68695C5C5C5C5C5C',
     9 Z'5C6A6B6C6D6E6F70',
     & Z'71725C5C5C5C5C5C',
     A Z'5C7E737475767778',
     & Z'797A5C5C5C5C5C5C',
     B Z'5C5C5C5C5C5C5C5C',
     & Z'5C5C5C5C5C5C5C5C',
     C Z'5B41424344454647',
     & Z'48495C5C5C5C5C5C',
     D Z'5D4A4B4C4D4E4F50',
     & Z'51525C5C5C5C5C5C',
     E Z'5C5C535455565758',
     & Z'595A5C5C5C5C5C5C',
     F Z'3031323334353637',
     & Z'38395C5C5C5C5CFF'/
C
C    ... WHERE FOLLOWING CLEAN ASCII WAS MODDED FOR # TO BLANK
C... 7 Z5C,Z5C,Z5C,Z5C,Z5C,Z5C,Z5C,Z5C, Z5C,Z60,Z3A,Z23,Z40,Z27,Z3D,Z22,
C    ... WHERE FOLLOWING C0 DEF IS WHAT AFOS USES FOR BIG L AT 5B
C ...C Z7B,Z41,Z42,Z43,Z44,Z45,Z46,Z47, Z48,Z49,Z5C,Z5C,Z5C,Z5C,Z5C,Z5C,
C ...D Z7D,Z4A,Z4B,Z4C,Z4D,Z4E,Z4F,Z50, Z51,Z52,Z5C,Z5C,Z5C,Z5C,Z5C,Z5C,
C
       NCH = NCHAR
       IF (NCH .LE. 0) THEN
           PRINT *,'***IN SUBR EB2ASC - NCHAR .LT. 0 ***'
           RETURN
       ENDIF
C
       DO 100 I = 1,NCH
         IACC = MOVA2I(LEXBCD(I))
         LASCII(I) = LTABLE(IACC+1)
  100  CONTINUE
C
       RETURN
       END
