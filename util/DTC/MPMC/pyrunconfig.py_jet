#!/usr/bin/env python
# Platform specific configure script for GSI build test on Cheyenne
# ---------------------------------------------------------------------------------------------------------------------------------------------------
# Customize the following  variables in the section below 
# 1. set full_regression_test to false for build only test
# 2. set create_build_report; toggles build report which is not supported with older versions of python.
# 3. batch queue charge code
# 4. username
# 5. Set a new location for the creation of the build directory. Default is the current directory location
# 6. Set a new location for the location of the source code. Default is the current directory location
full_regression_test = False   # not currently used, placeholder
create_build_report = False     # Needs to be false if python is older than v2.8
project_code = "wrfruc"
platform_username = "Guoqing.Ge"
build_directory_location = '/lfs3/projects/wrfruc/gge/MPMC/build_v3.7b'                                         # Location for creation of build directories.
build_directory_root = '/lfs3/projects/wrfruc/gge/MPMC/MPMCtest' # Location of python scripts
gsi_src_directory = '/lfs3/projects/wrfruc/gge/git/ProdGSI'                                             # Location of GSI source code
# ---------------------------------------------------------------------------------------------------------------------------------------------------
# Each line is a compiler test configuration, add or remove lines as needed. Syntax note: last line has no comma at the end of the line. 
# ---------------------------------------------------------------------------------------------------------------------------------------------------
#        compiler module name  |  additional platform modules |  mpi module name  |  lapack module name  |  netcdf module name  |  shell command for CC, CXX, and FC 
# ---------------------------------------------------------------------------------------------------------------------------------------------------
cfg = [
       {'id':'ji01', 'comp' : 'intel/18.0.3.222','comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji02', 'comp' : 'intel/18.0.3.222','comp_post' : '','mpi' : 'mvapich2/1.8'  ,'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji03', 'comp' : 'intel/2016.2.181','comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji04', 'comp' : 'intel/2016.2.181','comp_post' : '','mpi' : 'mvapich2/1.8'  ,'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji05', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#comment out compiler options that are known will not work                                                                                                                             
#      s{'id':'ji06', 'comp' : 'intel/14.0.3',    'comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#      s{'id':'ji07', 'comp' : 'intel/13.1.1',    'comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#      s{'id':'ji08', 'comp' : 'intel/12.1.5',    'comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#      s{'id':'ji09', 'comp' : 'intel/12.1.4',    'comp_post' : '','mpi' : 'impi/5.1.1.109','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji10', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'impi/2018.0.3', 'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji11', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'impi/5.0.3.048','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji12', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'impi/5.1.3.181','lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji13', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'mvapich2/1.6',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji14', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'mvapich2/1.8',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji15', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'mvapich2/1.9',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ji16', 'comp' : 'intel/15.0.3.187','comp_post' : '','mpi' : 'mvapich2/2.1',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },

       {'id':'jp01', 'comp' : 'pgi/18.3-0',      'comp_post' : '','mpi' : 'mvapich2/1.8',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#      s{'id':'jp02', 'comp' : 'pgi/15.3',        'comp_post' : '','mpi' : 'mvapich2/1.8',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#      s{'id':'jp03', 'comp' : 'pgi/14.3-0',      'comp_post' : '','mpi' : 'mvapich2/1.8',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#      s{'id':'jp04', 'comp' : 'pgi/13.2-0',      'comp_post' : '','mpi' : 'mvapich2/1.8',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#know_issues{'id':'jp05', 'comp' : 'pgi/12.5-0',      'comp_post' : '','mpi' : 'mvapich2/1.8',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#know_issues{'id':'jp06', 'comp' : 'pgi/15.3',        'comp_post' : '','mpi' : 'mvapich2/2.1',  'lapack' : '','netcdf' : 'szip hdf5 netcdf4/4.2.1.1','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' } 
      ]
#                    
# --------------------------USERS SHOULD NOT NEEED TO EDIT ANYTHING BELOW THIS LINE. EVERYTHING BELOW HERE IS PLATFORM SPECIFIC----------------------
# Name of machine name 
machine_name = 'JET'
# 
cmake_version = ''
# Platform specific (batch queue commands, etc.)
queue_name = 'batch'   #  'debug' limited to only two jobs
# Text for batch queue submission script
batch_queue_pre = '#PBS -N ' 
batch_queue_varaibles = '#PBS -A ' + project_code + ' \n#PBS -l walltime=00:30:00 \n#PBS -q '  \
      + queue_name + '\n#PBS -l procs=8 \n#PBS -l partition=tjet \n#PBS -j oe \n\n'
batch_queue_module_pre = 'source /etc/profile.d/modules.sh \nmodule purge \nmodule load newdefaults \n'
dry_mode = False  # When True don't submit to batch queue. Only set up scripts and directories.
