#!/usr/bin/env python
# Platform specific configure script for GSI build test on Cheyenne
# ---------------------------------------------------------------------------------------------------------------------------------------------------
# Customize the following  variables in the section below 
# 1. set full_regression_test to false for build only test
# 2. set create_build_report; toggles build report which is not supported with older versions of python.
# 3. batch queue charge code
# 4. username
# 5. Set a new location for the creation of the build directory. Default is the current directory location
# 6. Set a new location for the location of the source code. Default is the current directory location
full_regression_test = False
create_build_report = False     # Needs to be false on jet because of very old version of python installed
project_code = "comgsi" #"wrfruc"
platform_username = "Guoqing.Ge"
build_directory_location = '/scratch4/BMC/comgsi/gge/MPMC/build_v3.7beta' # Location for creation of build directories. 
build_directory_root = '/scratch4/BMC/comgsi/gge/MPMC/MPMCtest'  # Location of python scripts
gsi_src_directory = '/scratch4/BMC/comgsi/gge/MPMC/ProdGSI'                 # Location of GSI source code
# ---------------------------------------------------------------------------------------------------------------------------------------------------
# Each line is a compiler test configuration, add or remove lines as needed. Syntax note: last line has no comma at the end of the line. 
# ---------------------------------------------------------------------------------------------------------------------------------------------------
#        compiler module name  |  additional platform modules |  mpi module name  |  lapack module name  |  netcdf module name  |  shell command for CC, CXX, and FC 
# ---------------------------------------------------------------------------------------------------------------------------------------------------
cfg = [
       {'id':'ti01', 'comp' : 'intel/18.1.163','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti02', 'comp' : 'intel/18.0.1.163','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti03', 'comp' : 'intel/18.0.0.128','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti04', 'comp' : 'intel/17.0.5.239','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti05', 'comp' : 'intel/16.1.150','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti06', 'comp' : 'intel/16.0.1.150','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti07', 'comp' : 'intel/15.6.233','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti08', 'comp' : 'intel/15.3.187','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti09', 'comp' : 'intel/15.1.133','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#comment out compiler options that are known will not work
#known {'id':'ti10', 'comp' : 'intel/15.0.0','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti11', 'comp' : 'intel/14.0.2','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#known {'id':'ti12', 'comp' : 'intel/13.1.3','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#known {'id':'ti13', 'comp' : 'intel/12-12.0.4.191','comp_post' : '','mpi' : 'impi/5.1.2.150','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },

       {'id':'ti21', 'comp' : 'intel/18.1.163','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti22', 'comp' : 'intel/18.0.1.163','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti23', 'comp' : 'intel/18.0.0.128','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti24', 'comp' : 'intel/17.0.5.239','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti25', 'comp' : 'intel/16.1.150','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti26', 'comp' : 'intel/16.0.1.150','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti27', 'comp' : 'intel/15.6.233','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti28', 'comp' : 'intel/15.3.187','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti29', 'comp' : 'intel/15.1.133','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#known {'id':'ti30', 'comp' : 'intel/15.0.0','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
       {'id':'ti31', 'comp' : 'intel/14.0.2','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#known {'id':'ti32', 'comp' : 'intel/13.1.3','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },
#known {'id':'ti33', 'comp' : 'intel/12-12.0.4.191','comp_post' : '','mpi' : 'mvapich2/2.1a','lapack' : '','netcdf' : 'netcdf/4.3.0','cc' : 'icc','cxx' : 'icpc','fc' : 'mpif90' },

###PGI at theia, can only use netcdf/4.4.0 and netcdf/3.6.3
#known {'id':'tp01','comp' : 'pgi/12.5','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#known {'id':'tp02','comp' : 'pgi/14.10','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
#known {'id':'tp03','comp' : 'pgi/15.1','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp04','comp' : 'pgi/16.5','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp05','comp' : 'pgi/16.7','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp06','comp' : 'pgi/16.9','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp07','comp' : 'pgi/16.10','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp08','comp' : 'pgi/17.1','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp09','comp' : 'pgi/17.3','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp10','comp' : 'pgi/17.5','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp11','comp' : 'pgi/17.7','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp12','comp' : 'pgi/17.10','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp13','comp' : 'pgi/18.1','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp14','comp' : 'pgi/18.3','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' },
       {'id':'tp15','comp' : 'pgi/18.5','comp_post' : '','mpi' : 'mvapich2/2.1a',  'lapack' : '','netcdf' : 'netcdf/4.4.0','cc' : 'pgcc','cxx' : 'pgc++','fc' : 'mpif90' }
      ]
#                    
# --------------------------USERS SHOULD NOT NEEED TO EDIT ANYTHING BELOW THIS LINE. EVERYTHING BELOW HERE IS PLATFORM SPECIFIC----------------------
# Name of machine name 
machine_name = 'THEIA'
# 
cmake_version = ''
# Platform specific (batch queue commands, etc.)
queue_name = 'batch'   #  'debug' limited to only two jobs
# Text for batch queue submission script
batch_queue_pre = '#PBS -N ' 
batch_queue_varaibles = '#PBS -A ' + project_code + ' \n#PBS -l walltime=00:30:00 \n#PBS -q '  \
      + queue_name + '\n#PBS -l procs=8 \n#PBS -j oe \n\n'
batch_queue_module_pre = 'source /etc/profile.d/modules.sh \nmodule purge \n'
dry_mode = False  # When True don't submit to batch queue. Only set up scripts and directories.
